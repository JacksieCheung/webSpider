***Something About WebCrawler***

## About Cookie:

### 1.cookie是什么：

+ cookie是一段信息，服务端用cookie来确定用户是否是是在线状态


### 2.cookie作用过程：

+ 假设你要登陆豆瓣，输入密码点登陆，你的客户端（浏览器）会发送请求给服务端，告诉它你要登陆。这个请求是没有cookie的。这个时候，服务端了解了你的请求，那么它会给你发送响应报文，告诉你我知道了，给你登陆。这里的响应报文，就带了cookie。客户端收到cookie之后，就会保存在本地，此后每一次发送请求报文都会带上cookie。当然cookie有时间有效性,就是过一段时间会失效（大概是60s）。失效后服务端会发送新的cookie，然后过程重复。


##  模拟登陆

### 为什么需要模拟登陆？

<p style="text-indent:2em">照着模拟登陆的代码打最后会发现，爬出来的东西是一个只有请求状态的响应报文，并不是网页的html源代码。我们总不可能模拟登陆半天最后只有一个200 ok success吧？所以单单一个模拟登陆并不能达到我们最后的目的。而模拟登陆目的其实只是为了获取cookie！（另外如果没有cookie访问豆瓣个人主页这种需要登陆才能访问的，会直接被墙在登陆界面</p>

### 代码的思路和实现：

<p style="text-indent:2em">这里提供的思路是我自己的，我不确定是不是最佳的，但是可以运行出来。以爬取我们豆瓣主页为例，首先要获取cookie，那么就要写一个模拟登陆。写完之后，需要再写一个爬虫来爬取我们目标网页，这个爬虫的实现就是最简单的爬虫（详见UsualWebCrawler.go）没错就是再写一个新的网址，新的爬虫。而这个爬虫是在模拟登陆获取的cookie的基础上实现的。（完整代码请看CompletedVersion.go）（cookie登陆可以看一下CookieSmulatedLogin.go）我们要做的，只是把cookie通过一个方法导入请求里面。（这里要注意不要把响应头里的set-cookie直接抓出来自己加在Header里。这种方法我试过是行不通的。原应大概是这里的cookie放在请求里不一定是string类型，而且不一定在header。）</p>



## 代码的一些改进：

<p style="text-indent:2em">最后不知道你有没有想过一个问题：既然cookie会变，那么这个程序是不是只能登陆60s内有效？是的。但是60s内足够爬取了。并且每一次登陆都会重新获取cookie，每一次运行基本上不会出问题。但如果你要长期登陆，或者同时爬取多个网址，别忘了你每一次请求都有响应报文，只需要照葫芦画瓢把cookie都加上就ok了。具体代码没有写，可以自己试试。
